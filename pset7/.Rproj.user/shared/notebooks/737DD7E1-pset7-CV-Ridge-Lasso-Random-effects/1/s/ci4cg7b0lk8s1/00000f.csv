"0","extract.ranef = function(lmer.model=NULL, lm.model=NULL){"
"0","  "
"0","  vars = names(ranef(lmer.model))"
"0","  lmer.coefs = NULL"
"0","  lm.coefs = NULL"
"0","  "
"0","  if(!is.null(lm.model)){"
"0","    lm.coefs = summary(lm.model)$coefficients %>%"
"0","      as.data.frame() %>%"
"0","      rownames_to_column(var='var') %>%"
"0","      filter(grepl(paste0(vars, collapse=""|""), var)) %>%"
"0","      rename(est='Estimate',"
"0","             se ='Std. Error') %>%"
"0","      dplyr::select(var, est, se) %>%"
"0","      mutate(model='glm')"
"0","  }"
"0","  "
"0","  for (j in vars){"
"0","    "
"0","    ## lmer"
"0","    est = ranef(lmer.model)[[j]] "
"0","    se  = se.ranef(lmer.model)[[j]] "
"0","    colnames(est) = 'est'"
"0","    colnames(se) = 'se'"
"0","    temp = data.frame(var = rownames(est), "
"0","                      est=est, "
"0","                      se=se, "
"0","                      model='glmer',"
"0","                      ranef = j)"
"0","    lmer.coefs = rbind(lmer.coefs, temp)"
"0","    "
"0","    ## lm"
"0","    if(!is.null(lm.model)){"
"0","      rows=grepl(j, lm.coefs$var)"
"0","      lm.coefs$var[rows] = lm.model$xlevels[[j]][-length(lm.model$xlevels[[j]])]"
"0","      lm.coefs$ranef[rows] = j"
"0","      "
"0","    } ## if lm.model"
"0","    "
"0","  } ## end j loop"
"0","  "
"0","  coefs = rbind(lmer.coefs, lm.coefs)"
"0","  return(coefs)"
"0","}"
